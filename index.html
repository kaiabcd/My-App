<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>å¯¶å¯å¤¢è­˜å­—å¡(ç›´å¼æ³¨éŸ³ç‰ˆ)</title>

<script src="https://unpkg.com/pinyin-pro@3.18.2/dist/index.js"></script>

<style>
  /* åŸºç¤è¨­å®š */
  * { 
    touch-action: manipulation; 
    -webkit-tap-highlight-color: transparent; 
    -webkit-user-select: none; user-select: none;
    box-sizing: border-box;
  }

  body {
    font-family: "KaiTi", "BiauKai", "DFKai-SB", "Microsoft JhengHei", serif;
    background-color: #f0f8ff;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    height: 100vh; margin: 0; padding: 10px;
    overflow: hidden; 
  }

  /* å¡ç‰‡ä¸»é«” */
  .card-container {
    width: 100%; max-width: 400px; height: 90vh; /* ç¨å¾®æ‹‰é«˜ä»¥å®¹ç´ç›´å¼æ³¨éŸ³ */
    background: white; border-radius: 20px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.15);
    display: flex; flex-direction: column; align-items: center;
    padding: 15px; border: 8px solid #FFCB05;
    position: relative; margin-bottom: 10px;
  }

  /* åœ–ç‰‡å€ */
  .img-area {
    flex: 1; width: 100%;
    display: flex; justify-content: center; align-items: center;
    background-color: #fafafa; border-radius: 15px;
    margin-bottom: 10px; border-bottom: 2px dashed #ddd;
    position: relative;
  }

  .img-area img {
    width: 90%; height: 90%; object-fit: contain;
    filter: drop-shadow(5px 5px 5px rgba(0,0,0,0.1));
  }

  .id-badge {
    position: absolute; top: 10px; left: 10px;
    background: #444; color: white; padding: 4px 12px;
    border-radius: 20px; font-size: 1rem; font-family: Arial, sans-serif;
  }

  /* --- é—œéµä¿®æ”¹ï¼šæ–‡å­—å€å¡Šä½ˆå±€ --- */
  .text-row {
    display: flex; 
    justify-content: center; 
    align-items: flex-start; /* æ”¹ç‚ºé ä¸Šå°é½Šï¼Œè®“åœ‹å­—åˆ‡é½Šï¼Œæ³¨éŸ³å¾€ä¸‹é•· */
    width: 100%; 
    height: auto; /* é«˜åº¦è‡ªå‹•ï¼Œç”±å…§å®¹æ’é–‹ */
    min-height: 180px; /* çµ¦äºˆè¶³å¤ ç©ºé–“æ”¾ç›´å¼æ³¨éŸ³ */
    gap: 8px; 
    padding-bottom: 10px;
  }

  /* å­—å¡å®¹å™¨ */
  #charContainer {
    display: flex; 
    justify-content: center; 
    align-items: flex-start; /* é ä¸Šå°é½Š */
    gap: 2px;
  }

  /* å–®å­—å€å¡Šï¼šå‚ç›´æ’åˆ— (å­—åœ¨ä¸Šï¼Œæ³¨éŸ³åœ¨ä¸‹) */
  .char-block {
    display: flex; 
    flex-direction: column; 
    align-items: center; 
    justify-content: flex-start;
    width: 4.5rem; /* å¯¬åº¦ç¨å¾®åŠ å¯¬ */
  }

  /* åœ‹å­—æ¨£å¼ */
  .char-text {
    font-size: 4rem; 
    font-weight: bold;
    line-height: 1; 
    color: #333; 
    margin-bottom: 10px; /* åœ‹å­—è·Ÿæ³¨éŸ³çš„è·é›¢ */
  }

  /* --- é—œéµä¿®æ”¹ï¼šç›´å¼æ³¨éŸ³æ¨£å¼ --- */
  .char-zhuyin {
    font-size: 1.4rem; /* æ³¨éŸ³å­—é«”å¤§å° */
    font-family: "BiauKai", "KaiTi", serif; /* å¿…é ˆç”¨æ¨™æ¥·é«”ï¼Œè²èª¿ä½ç½®æ‰æœƒå° */
    font-weight: normal; 
    color: #555; 
    
    /* æ ¸å¿ƒ CSSï¼šå‚ç›´æ›¸å¯«æ¨¡å¼ */
    writing-mode: vertical-rl; 
    text-orientation: upright; /* è®“ç¬¦è™Ÿç«™ç›´ï¼Œä¸è¦è½‰90åº¦ */
    
    letter-spacing: 0.2rem; /* æ‹‰é–‹æ³¨éŸ³ç¬¦è™Ÿé–“è·ï¼Œæ›´åƒä½œæ¥­ç°¿ */
    height: auto;
  }

  /* å–‡å­æŒ‰éˆ• (èª¿æ•´ä½ç½®) */
  .audio-btn {
    background: #ff5722; color: white; border: none; border-radius: 50%;
    width: 45px; height: 45px; font-size: 1.2rem;
    cursor: pointer; display: flex; align-items: center; justify-content: center;
    box-shadow: 0 3px 5px rgba(0,0,0,0.2); flex-shrink: 0;
    margin-top: 20px; /* å°é½Šæ–‡å­—ä¸Šæ–¹ */
  }
  .audio-btn:active { transform: scale(0.9); }

  /* æ§åˆ¶æŒ‰éˆ• */
  .controls { display: flex; gap: 8px; width: 100%; max-width: 400px; height: 55px; }
  button {
    border: none; border-radius: 12px; color: white; cursor: pointer;
    font-size: 1.2rem; font-weight: bold; box-shadow: 0 4px 0 rgba(0,0,0,0.1);
  }
  button:active { transform: translateY(2px); box-shadow: none; }
  .nav-btn { background-color: #2196F3; flex: 1; }
  .rand-btn { background-color: #ff9800; flex: 1.5; font-size: 1.6rem; }
  .list-btn { background-color: #9c27b0; width: 50px; font-size: 1.4rem; }

  /* æ¸…å–®è¦–çª— */
  .modal { display: none; position: fixed; z-index: 999; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); align-items: center; justify-content: center; }
  .modal-content { background-color: white; width: 95%; max-width: 600px; height: 90%; border-radius: 15px; display: flex; flex-direction: column; }
  .modal-header { padding: 15px; background: #2196F3; color: white; display: flex; justify-content: space-between; align-items: center; font-size: 1.2rem; font-weight: bold; }
  .close-btn { background: none; border: none; color: white; font-size: 24px; }
  .modal-body { padding: 10px; overflow-y: auto; display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 8px; }
  .list-item { background: #f5f5f5; padding: 10px 5px; border-radius: 8px; text-align: center; border: 1px solid #ddd; }
  .list-item span { display: block; font-size: 12px; color: #888; margin-bottom: 2px;}
</style>
</head>
<body oncontextmenu="return false;">

  <div class="card-container">
    <div class="img-area">
      <div class="id-badge" id="cardIdBadge">No.---</div>
      <img id="cardImage" src="" alt="Pokemon">
    </div>
    
    <div class="text-row">
      <div id="charContainer" onclick="playAudio()">è¼‰å…¥ä¸­</div>
      <button class="audio-btn" onclick="playAudio()">ğŸ”Š</button>
    </div>
  </div>

  <div class="controls">
    <button class="nav-btn" onclick="prevCard()">â—€</button>
    <button class="rand-btn" onclick="randomCard()">ğŸ²</button>
    <button class="nav-btn" onclick="nextCard()">â–¶</button>
    <button class="list-btn" onclick="toggleList()">ğŸ“œ</button>
  </div>

  <div id="listModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <span>å¯¶å¯å¤¢æ¸…å–®</span>
        <button class="close-btn" onclick="toggleList()">Ã—</button>
      </div>
      <div class="modal-body" id="listContainer"></div>
    </div>
  </div>

<script>
  // 1. ä¿ç•™åŸæœ¬çš„æ‰‹å‹•å»ºç«‹ Gen 1 æ³¨éŸ³è¡¨ (100% æº–ç¢ºã„…ã„†ã„‡)
  const gen1_manual = [
    {n:"å¦™è›™ç¨®å­",z:["ã„‡ã„§ã„ Ë‹","ã„¨ã„š","ã„“ã„¨ã„¥Ë‡","ã„—Ë‡"]},{n:"å¦™è›™è‰",z:["ã„‡ã„§ã„ Ë‹","ã„¨ã„š","ã„˜ã„ Ë‡"]},{n:"å¦™è›™èŠ±",z:["ã„‡ã„§ã„ Ë‹","ã„¨ã„š","ã„ã„¨ã„š"]},{n:"å°ç«é¾",z:["ã„’ã„§ã„ Ë‡","ã„ã„¨ã„›Ë‡","ã„Œã„¨ã„¥ËŠ"]},{n:"ç«æé¾",z:["ã„ã„¨ã„›Ë‡","ã„ã„¨ã„¥Ë‡","ã„Œã„¨ã„¥ËŠ"]},{n:"å™´ç«é¾",z:["ã„†ã„£","ã„ã„¨ã„›Ë‡","ã„Œã„¨ã„¥ËŠ"]},{n:"å‚‘å°¼é¾œ",z:["ã„ã„§ã„ËŠ","ã„‹ã„§ËŠ","ã„ã„¨ã„Ÿ"]},{n:"å¡å’ªé¾œ",z:["ã„ã„šË‡","ã„‡ã„§","ã„ã„¨ã„Ÿ"]},{n:"æ°´ç®­é¾œ",z:["ã„•ã„¨ã„ŸË‡","ã„ã„§ã„¢Ë‹","ã„ã„¨ã„Ÿ"]},{n:"ç¶ æ¯›èŸ²",z:["ã„Œã„©Ë‹","ã„‡ã„ ËŠ","ã„”ã„¨ã„¥ËŠ"]},
    {n:"éµç”²è›¹",z:["ã„Šã„§ã„Ë‡","ã„ã„§ã„šË‡","ã„©ã„¥Ë‡"]},{n:"å·´å¤§è¶",z:["ã„…ã„š","ã„‰ã„šË‹","ã„‰ã„§ã„ËŠ"]},{n:"ç¨è§’èŸ²",z:["ã„‰ã„¨ËŠ","ã„ã„§ã„ Ë‡","ã„”ã„¨ã„¥ËŠ"]},{n:"éµæ®¼è›¹",z:["ã„Šã„§ã„Ë‡","ã„ã„œËŠ","ã„©ã„¥Ë‡"]},{n:"å¤§é‡èœ‚",z:["ã„‰ã„šË‹","ã„“ã„£","ã„ˆã„¥"]},{n:"æ³¢æ³¢",z:["ã„†ã„›","ã„†ã„›"]},{n:"æ¯”æ¯”é³¥",z:["ã„…ã„§Ë‡","ã„…ã„§Ë‡","ã„‹ã„§ã„ Ë‡"]},{n:"å¤§æ¯”é³¥",z:["ã„‰ã„šË‹","ã„…ã„§Ë‡","ã„‹ã„§ã„ Ë‡"]},{n:"å°æ‹‰é”",z:["ã„’ã„§ã„ Ë‡","ã„Œã„š","ã„‰ã„šËŠ"]},{n:"æ‹‰é”",z:["ã„Œã„š","ã„‰ã„šËŠ"]},
    {n:"çƒˆé›€",z:["ã„Œã„§ã„Ë‹","ã„‘ã„©ã„Ë‹"]},{n:"å¤§å˜´é›€",z:["ã„‰ã„šË‹","ã„—ã„¨ã„ŸË‡","ã„‘ã„©ã„Ë‹"]},{n:"é˜¿æŸè›‡",z:["ã„š","ã„…ã„›ËŠ","ã„•ã„œËŠ"]},{n:"é˜¿æŸæ€ª",z:["ã„š","ã„…ã„›ËŠ","ã„ã„¨ã„Ë‹"]},{n:"çš®å¡ä¸˜",z:["ã„†ã„§ËŠ","ã„ã„šË‡","ã„‘ã„§ã„¡"]},{n:"é›·ä¸˜",z:["ã„Œã„ŸËŠ","ã„‘ã„§ã„¡"]},{n:"ç©¿å±±é¼ ",z:["ã„”ã„¨ã„¢","ã„•ã„¢","ã„•ã„¨Ë‡"]},{n:"ç©¿å±±ç‹",z:["ã„”ã„¨ã„¢","ã„•ã„¢","ã„¨ã„¤ËŠ"]},{n:"å°¼å¤šè˜­",z:["ã„‹ã„§ËŠ","ã„‰ã„¨ã„›","ã„Œã„¢ËŠ"]},{n:"å°¼å¤šå¨œ",z:["ã„‹ã„§ËŠ","ã„‰ã„¨ã„›","ã„‹ã„šË‹"]},
    {n:"å°¼å¤šå",z:["ã„‹ã„§ËŠ","ã„‰ã„¨ã„›","ã„ã„¡Ë‹"]},{n:"å°¼å¤šæœ—",z:["ã„‹ã„§ËŠ","ã„‰ã„¨ã„›","ã„Œã„¤Ë‡"]},{n:"å°¼å¤šåŠ›è«¾",z:["ã„‹ã„§ËŠ","ã„‰ã„¨ã„›","ã„Œã„§Ë‹","ã„‹ã„¨ã„›Ë‹"]},{n:"å°¼å¤šç‹",z:["ã„‹ã„§ËŠ","ã„‰ã„¨ã„›","ã„¨ã„¤ËŠ"]},{n:"çš®çš®",z:["ã„†ã„§ËŠ","ã„†ã„§ËŠ"]},{n:"çš®å¯è¥¿",z:["ã„†ã„§ËŠ","ã„ã„œË‡","ã„’ã„§"]},{n:"å…­å°¾",z:["ã„Œã„§ã„¡Ë‹","ã„¨ã„ŸË‡"]},{n:"ä¹å°¾",z:["ã„ã„§ã„¡Ë‡","ã„¨ã„ŸË‡"]},{n:"èƒ–ä¸",z:["ã„†ã„¤Ë‹","ã„‰ã„§ã„¥"]},{n:"èƒ–å¯ä¸",z:["ã„†ã„¤Ë‹","ã„ã„œË‡","ã„‰ã„§ã„¥"]},
    {n:"è¶…éŸ³è ",z:["ã„”ã„ ","ã„§ã„£","ã„ˆã„¨ËŠ"]},{n:"å¤§å˜´è ",z:["ã„‰ã„šË‹","ã„—ã„¨ã„ŸË‡","ã„ˆã„¨ËŠ"]},{n:"èµ°è·¯è‰",z:["ã„—ã„¡Ë‡","ã„Œã„¨Ë‹","ã„˜ã„ Ë‡"]},{n:"è‡­è‡­èŠ±",z:["ã„”ã„¡Ë‹","ã„”ã„¡Ë‹","ã„ã„¨ã„š"]},{n:"éœ¸ç‹èŠ±",z:["ã„…ã„šË‹","ã„¨ã„¤ËŠ","ã„ã„¨ã„š"]},{n:"æ´¾æ‹‰æ–¯",z:["ã„†ã„Ë‹","ã„Œã„š","ã„™"]},{n:"æ´¾æ‹‰æ–¯ç‰¹",z:["ã„†ã„Ë‹","ã„Œã„š","ã„™","ã„Šã„œË‹"]},{n:"æ¯›çƒ",z:["ã„‡ã„ ËŠ","ã„‘ã„§ã„¡ËŠ"]},{n:"æ‘©é­¯è›¾",z:["ã„‡ã„›ËŠ","ã„Œã„¨Ë‡","ã„œËŠ"]},{n:"åœ°é¼ ",z:["ã„‰ã„§Ë‹","ã„•ã„¨Ë‡"]},
    {n:"ä¸‰åœ°é¼ ",z:["ã„™ã„¢","ã„‰ã„§Ë‹","ã„•ã„¨Ë‡"]},{n:"å–µå–µ",z:["ã„‡ã„§ã„ ","ã„‡ã„§ã„ "]},{n:"è²“è€å¤§",z:["ã„‡ã„ ","ã„Œã„ Ë‡","ã„‰ã„šË‹"]},{n:"å¯é”é´¨",z:["ã„ã„œÄ›","ã„‰ã„šËŠ","ã„§ã„š"]},{n:"å“¥é”é´¨",z:["ã„ã„œ","ã„‰ã„šËŠ","ã„§ã„š"]},{n:"çŒ´æ€ª",z:["ã„ã„¡ËŠ","ã„ã„¨ã„Ë‹"]},{n:"ç«çˆ†çŒ´",z:["ã„ã„¨ã„›Ë‡","ã„…ã„ Ë‹","ã„ã„¡ËŠ"]},{n:"å¡è’‚ç‹—",z:["ã„ã„šË‡","ã„‰ã„§Ë‹","ã„ã„¡Ë‡"]},{n:"é¢¨é€Ÿç‹—",z:["ã„ˆã„¥","ã„™ã„¨Ë‹","ã„ã„¡Ë‡"]},{n:"èšŠé¦™èŒèšª",z:["ã„¨ã„£ËŠ","ã„’ã„§ã„¤","ã„ã„œ","ã„‰ã„¡Ë‡"]},
    {n:"èšŠé¦™å›",z:["ã„¨ã„£ËŠ","ã„’ã„§ã„¤","ã„ã„©ã„£"]},{n:"èšŠé¦™æ³³å£«",z:["ã„¨ã„£ËŠ","ã„’ã„§ã„¤","ã„©ã„¥Ë‡","ã„•Ë‹"]},{n:"å‡±è¥¿",z:["ã„ã„Ë‡","ã„’ã„§"]},{n:"å‹‡åŸºæ‹‰",z:["ã„©ã„¥Ë‡","ã„ã„§","ã„Œã„š"]},{n:"èƒ¡åœ°",z:["ã„ã„¨ËŠ","ã„‰ã„§Ë‹"]},{n:"è…•åŠ›",z:["ã„¨ã„¢Ë‹","ã„Œã„§Ë‹"]},{n:"è±ªåŠ›",z:["ã„ã„ ËŠ","ã„Œã„§Ë‹"]},{n:"æ€ªåŠ›",z:["ã„ã„¨ã„Ë‹","ã„Œã„§Ë‹"]},{n:"å–‡å­èŠ½",z:["ã„Œã„šË‡","ã„…ã„š","ã„§ã„šËŠ"]},{n:"å£å‘†èŠ±",z:["ã„ã„¡Ë‡","ã„‰ã„","ã„ã„¨ã„š"]},
    {n:"å¤§é£ŸèŠ±",z:["ã„‰ã„šË‹","ã„•ËŠ","ã„ã„¨ã„š"]},{n:"ç‘ªç‘™æ°´æ¯",z:["ã„‡ã„šË‡","ã„‹ã„ Ë‡","ã„•ã„¨ã„ŸË‡","ã„‡ã„¨Ë‡"]},{n:"æ¯’åˆºæ°´æ¯",z:["ã„‰ã„¨ËŠ","ã„˜Ë‹","ã„•ã„¨ã„ŸË‡","ã„‡ã„¨Ë‡"]},{n:"å°æ‹³çŸ³",z:["ã„’ã„§ã„ Ë‡","ã„‘ã„©ã„¢ËŠ","ã„•ËŠ"]},{n:"éš†éš†çŸ³",z:["ã„Œã„¨ã„¥ËŠ","ã„Œã„¨ã„¥ËŠ","ã„•ËŠ"]},{n:"éš†éš†å²©",z:["ã„Œã„¨ã„¥ËŠ","ã„Œã„¨ã„¥ËŠ","ã„§ã„¢ËŠ"]},{n:"å°ç«é¦¬",z:["ã„’ã„§ã„ Ë‡","ã„ã„¨ã„›Ë‡","ã„‡ã„šË‡"]},{n:"çƒˆç„°é¦¬",z:["ã„Œã„§ã„Ë‹","ã„§ã„¢Ë‹","ã„‡ã„šË‡"]},{n:"å‘†å‘†ç¸",z:["ã„‰ã„","ã„‰ã„","ã„•ã„¡Ë‹"]},{n:"å‘†æ®¼ç¸",z:["ã„‰ã„","ã„ã„œËŠ","ã„•ã„¡Ë‹"]},
    {n:"å°ç£æ€ª",z:["ã„’ã„§ã„ Ë‡","ã„˜ËŠ","ã„ã„¨ã„Ë‹"]},{n:"ä¸‰åˆä¸€ç£æ€ª",z:["ã„™ã„¢","ã„ã„œËŠ","ã„§","ã„˜ËŠ","ã„ã„¨ã„Ë‹"]},{n:"å¤§è”¥é´¨",z:["ã„‰ã„šË‹","ã„˜ã„¨ã„¥","ã„§ã„š"]},{n:"å˜Ÿå˜Ÿ",z:["ã„‰ã„¨","ã„‰ã„¨"]},{n:"å˜Ÿå˜Ÿåˆ©",z:["ã„‰ã„¨","ã„‰ã„¨","ã„Œã„§Ë‹"]},{n:"å°æµ·ç…",z:["ã„’ã„§ã„ Ë‡","ã„ã„Ë‡","ã„•"]},{n:"ç™½æµ·ç…",z:["ã„…ã„ËŠ","ã„ã„Ë‡","ã„•"]},{n:"è‡­æ³¥",z:["ã„”ã„¡Ë‹","ã„‹ã„§ËŠ"]},{n:"è‡­è‡­æ³¥",z:["ã„”ã„¡Ë‹","ã„”ã„¡Ë‹","ã„‹ã„§ËŠ"]},{n:"å¤§èˆŒè²",z:["ã„‰ã„šË‹","ã„•ã„œËŠ","ã„…ã„ŸË‹"]},
    {n:"åˆºç”²è²",z:["ã„˜Ë‹","ã„ã„§ã„šË‡","ã„…ã„ŸË‹"]},{n:"é¬¼æ–¯",z:["ã„ã„¨ã„ŸË‡","ã„™"]},{n:"é¬¼æ–¯é€š",z:["ã„ã„¨ã„ŸË‡","ã„™","ã„Šã„¨ã„¥"]},{n:"è€¿é¬¼",z:["ã„ã„¥Ë‡","ã„ã„¨ã„ŸË‡"]},{n:"å¤§å²©è›‡",z:["ã„‰ã„šË‹","ã„§ã„¢ËŠ","ã„•ã„œËŠ"]},{n:"å‚¬çœ è²˜",z:["ã„˜ã„¨ã„Ÿ","ã„‡ã„§ã„¢ËŠ","ã„‡ã„›Ë‹"]},{n:"å¼•å¤¢è²˜äºº",z:["ã„§ã„£Ë‡","ã„‡ã„¥Ë‹","ã„‡ã„›Ë‹","ã„–ã„£ËŠ"]},{n:"å¤§é‰—èŸ¹",z:["ã„‰ã„šË‹","ã„‘ã„§ã„¢ËŠ","ã„’ã„§ã„Ë‹"]},{n:"å·¨é‰—èŸ¹",z:["ã„ã„©Ë‹","ã„‘ã„§ã„¢ËŠ","ã„’ã„§ã„Ë‹"]},{n:"éœ¹é‚é›»çƒ",z:["ã„†ã„§","ã„Œã„§Ë‹","ã„‰ã„§ã„¢Ë‹","ã„‘ã„§ã„¡ËŠ"]},
    {n:"é ‘çš®é›·å½ˆ",z:["ã„¨ã„¢ËŠ","ã„†ã„§ËŠ","ã„Œã„ŸËŠ","ã„‰ã„¢Ë‹"]},{n:"è›‹è›‹",z:["ã„‰ã„¢Ë‹","ã„‰ã„¢Ë‹"]},{n:"æ¤°è›‹æ¨¹",z:["ã„§ã„ËŠ","ã„‰ã„¢Ë‹","ã„•ã„¨Ë‹"]},{n:"å¡æ‹‰å¡æ‹‰",z:["ã„ã„šË‡","ã„Œã„š","ã„ã„šË‡","ã„Œã„š"]},{n:"å˜å•¦å˜å•¦",z:["ã„ã„š","ã„Œã„š","ã„ã„š","ã„Œã„š"]},{n:"é£›è…¿éƒ",z:["ã„ˆã„Ÿ","ã„Šã„¨ã„ŸË‡","ã„Œã„¤ËŠ"]},{n:"å¿«æ‹³éƒ",z:["ã„ã„¨ã„Ë‹","ã„‘ã„©ã„¢ËŠ","ã„Œã„¤ËŠ"]},{n:"å¤§èˆŒé ­",z:["ã„‰ã„šË‹","ã„•ã„œËŠ","ã„Šã„¡ËŠ"]},{n:"ç“¦æ–¯å½ˆ",z:["ã„¨ã„šË‡","ã„™","ã„‰ã„¢Ë‹"]},{n:"é›™å½ˆç“¦æ–¯",z:["ã„•ã„¨ã„¤","ã„‰ã„¢Ë‹","ã„¨ã„šË‡","ã„™"]},
    {n:"ç¨è§’çŠ€ç‰›",z:["ã„‰ã„¨ËŠ","ã„ã„§ã„ Ë‡","ã„’ã„§","ã„‹ã„§ã„¡ËŠ"]},{n:"é‘½è§’çŠ€ç¸",z:["ã„—ã„¨ã„¢","ã„ã„§ã„ Ë‡","ã„’ã„§","ã„•ã„¡Ë‹"]},{n:"å‰åˆ©è›‹",z:["ã„ã„§ËŠ","ã„Œã„§Ë‹","ã„‰ã„¢Ë‹"]},{n:"è”“è—¤æ€ª",z:["ã„‡ã„¢Ë‹","ã„Šã„¥ËŠ","ã„ã„¨ã„Ë‹"]},{n:"è¢‹ç¸",z:["ã„‰ã„Ë‹","ã„•ã„¡Ë‹"]},{n:"å¢¨æµ·é¦¬",z:["ã„‡ã„›Ë‹","ã„ã„Ë‡","ã„‡ã„šË‡"]},{n:"æµ·åˆºé¾",z:["ã„ã„Ë‡","ã„˜Ë‹","ã„Œã„¨ã„¥ËŠ"]},{n:"è§’é‡‘é­š",z:["ã„ã„§ã„ Ë‡","ã„ã„§ã„£","ã„©ËŠ"]},{n:"é‡‘é­šç‹",z:["ã„ã„§ã„£","ã„©ËŠ","ã„¨ã„¤ËŠ"]},{n:"æµ·æ˜Ÿæ˜Ÿ",z:["ã„ã„Ë‡","ã„’ã„§ã„¥","ã„’ã„§ã„¥"]},
    {n:"å¯¶çŸ³æµ·æ˜Ÿ",z:["ã„…ã„ Ë‡","ã„•ËŠ","ã„ã„Ë‡","ã„’ã„§ã„¥"]},{n:"é­”ç‰†äººå¶",z:["ã„‡ã„›ËŠ","ã„‘ã„§ã„¤ËŠ","ã„–ã„£ËŠ","ã„¡Ë‡"]},{n:"é£›å¤©è³è‚",z:["ã„ˆã„Ÿ","ã„Šã„§ã„¢","ã„Šã„¤ËŠ","ã„Œã„¤ËŠ"]},{n:"è¿·å”‡å§",z:["ã„‡ã„§ËŠ","ã„”ã„¨ã„£ËŠ","ã„ã„§ã„Ë‡"]},{n:"é›»æ“Šç¸",z:["ã„‰ã„§ã„¢Ë‹","ã„ã„§ËŠ","ã„•ã„¡Ë‹"]},{n:"é´¨å˜´ç«ç¸",z:["ã„§ã„š","ã„—ã„¨ã„ŸË‡","ã„ã„¨ã„›Ë‡","ã„•ã„¡Ë‹"]},{n:"å‡±ç¾…æ–¯",z:["ã„ã„Ë‡","ã„Œã„¨ã„›ËŠ","ã„™"]},{n:"è‚¯æ³°ç¾…",z:["ã„ã„£Ë‡","ã„Šã„Ë‹","ã„Œã„¨ã„›ËŠ"]},{n:"é¯‰é­šç‹",z:["ã„Œã„§Ë‡","ã„©ËŠ","ã„¨ã„¤ËŠ"]},{n:"æš´é¯‰é¾",z:["ã„…ã„ Ë‹","ã„Œã„§Ë‡","ã„Œã„¨ã„¥ËŠ"]},
    {n:"æ‹‰æ™®æ‹‰æ–¯",z:["ã„Œã„š","ã„†ã„¨Ë‡","ã„Œã„š","ã„™"]},{n:"ç™¾è®Šæ€ª",z:["ã„…ã„Ë‡","ã„…ã„§ã„¢Ë‹","ã„ã„¨ã„Ë‹"]},{n:"ä¼Šå¸ƒ",z:["ã„§","ã„…ã„¨Ë‹"]},{n:"æ°´ä¼Šå¸ƒ",z:["ã„•ã„¨ã„ŸË‡","ã„§","ã„…ã„¨Ë‹"]},{n:"é›·ä¼Šå¸ƒ",z:["ã„Œã„ŸËŠ","ã„§","ã„…ã„¨Ë‹"]},{n:"ç«ä¼Šå¸ƒ",z:["ã„ã„¨ã„›Ë‡","ã„§","ã„…ã„¨Ë‹"]},{n:"å¤šé‚Šç¸",z:["ã„‰ã„¨ã„›","ã„…ã„§ã„¢","ã„•ã„¡Ë‹"]},{n:"èŠçŸ³ç¸",z:["ã„ã„©ËŠ","ã„•ËŠ","ã„•ã„¡Ë‹"]},{n:"å¤šåˆºèŠçŸ³ç¸",z:["ã„‰ã„¨ã„›","ã„˜Ë‹","ã„ã„©ËŠ","ã„•ËŠ","ã„•ã„¡Ë‹"]},{n:"åŒ–çŸ³ç›”",z:["ã„ã„¨ã„šË‹","ã„•ËŠ","ã„ã„¨ã„Ÿ"]},
    {n:"é®åˆ€ç›”",z:["ã„Œã„§ã„¢ËŠ","ã„‰ã„ ","ã„ã„¨ã„Ÿ"]},{n:"åŒ–çŸ³ç¿¼é¾",z:["ã„ã„¨ã„šË‹","ã„•ËŠ","ã„§Ë‹","ã„Œã„¨ã„¥ËŠ"]},{n:"å¡æ¯”ç¸",z:["ã„ã„šË‡","ã„…ã„§Ë‡","ã„•ã„¡Ë‹"]},{n:"æ€¥å‡é³¥",z:["ã„ã„§ËŠ","ã„‰ã„¨ã„¥Ë‹","ã„‹ã„§ã„ Ë‡"]},{n:"é–ƒé›»é³¥",z:["ã„•ã„¢Ë‡","ã„‰ã„§ã„¢Ë‹","ã„‹ã„§ã„ Ë‡"]},{n:"ç«ç„°é³¥",z:["ã„ã„¨ã„›Ë‡","ã„§ã„¢Ë‹","ã„‹ã„§ã„ Ë‡"]},{n:"è¿·ä½ é¾",z:["ã„‡ã„§ËŠ","ã„‹ã„§Ë‡","ã„Œã„¨ã„¥ËŠ"]},{n:"å“ˆå…‹é¾",z:["ã„ã„š","ã„ã„œË‹","ã„Œã„¨ã„¥ËŠ"]},{n:"å¿«é¾",z:["ã„ã„¨ã„Ë‹","ã„Œã„¨ã„¥ËŠ"]},{n:"è¶…å¤¢",z:["ã„”ã„ ","ã„‡ã„¥Ë‹"]},{n:"å¤¢å¹»",z:["ã„‡ã„¥Ë‹","ã„ã„¨ã„¢Ë‹"]}
  ];

  // (å…¶é¤˜ä¸–ä»£ä½¿ç”¨ pinyin-pro è‡ªå‹•è½‰æ›ï¼Œé€™è£¡ç‚ºäº†ç°¡æ½”é¡¯ç¤ºç‚ºç©ºï¼Œè«‹æ‚¨è¨˜å¾—å¡«å›åŸæœ¬çš„è³‡æ–™)
  const gen2_raw=["èŠè‰è‘‰","æœˆæ¡‚è‘‰","å¤§ç«ºè‘µ"]; // ç¯„ä¾‹
  const gen3_raw=[];
  const gen4_raw=[];
  const gen5_raw=[];
  const gen6_raw=[];
  const gen7_raw=[];
  const gen8_raw=[];
  const gen9_raw=[];

  let allData = [];
  
  // 1. è™•ç† Gen 1
  gen1_manual.forEach((item, index) => {
    allData.push({
      name: item.n,
      zhuyin: item.z,
      id: (index + 1).toString().padStart(3, '0')
    });
  });

  // 2. è™•ç† Gen 2-9
  const otherGens = [].concat(gen2_raw, gen3_raw, gen4_raw, gen5_raw, gen6_raw, gen7_raw, gen8_raw, gen9_raw);
  let baseIndex = 151;
  const { pinyin } = window.pinyinPro || { pinyin: null };

  otherGens.forEach((name, i) => {
    const id = (baseIndex + i + 1).toString().padStart(3, '0');
    let zList = [];
    if (pinyin) {
      try {
        zList = pinyin(name, { pattern: 'zhuyin', type: 'array', toneType: 'symbol' });
      } catch (e) {
        zList = new Array(name.length).fill(""); 
      }
    } else {
      zList = new Array(name.length).fill("");
    }
    allData.push({ name: name, zhuyin: zList, id: id });
  });

  let currentIndex = 0;
  const charContainer = document.getElementById('charContainer');
  const idBadgeElement = document.getElementById('cardIdBadge');
  const imgElement = document.getElementById('cardImage');
  const modalElement = document.getElementById('listModal');
  const listContainer = document.getElementById('listContainer');

  initGame();

  function initGame() {
    generateList();
    randomCard();
  }

  function updateCard() {
    const data = allData[currentIndex];
    idBadgeElement.innerText = `No. ${data.id}`;
    imgElement.src = `https://assets.pokemon.com/assets/cms2/img/pokedex/full/${data.id}.png`;

    let html = '';
    const zhuyinArray = data.zhuyin || [];

    for (let i = 0; i < data.name.length; i++) {
      const char = data.name[i];
      let z = zhuyinArray[i] || "";
      if (/[a-zA-Z]/.test(z)) z = ""; 

      html += `
        <div class="char-block">
          <div class="char-text">${char}</div>
          <div class="char-zhuyin">${z}</div>
        </div>
      `;
    }
    charContainer.innerHTML = html;
  }

  function playAudio() {
    const text = allData[currentIndex].name;
    window.speechSynthesis.cancel();
    const utterance = new SpeechSynthesisUtterance(text);
    utterance.lang = 'zh-TW';
    utterance.rate = 0.8;
    utterance.pitch = 1.1;
    window.speechSynthesis.speak(utterance);
  }

  function nextCard() {
    currentIndex++;
    if (currentIndex >= allData.length) currentIndex = 0;
    updateCard();
  }

  function prevCard() {
    currentIndex--;
    if (currentIndex < 0) currentIndex = allData.length - 1;
    updateCard();
  }

  function randomCard() {
    let newIndex;
    do { newIndex = Math.floor(Math.random() * allData.length); } while (newIndex === currentIndex);
    currentIndex = newIndex;
    updateCard();
  }

  function toggleList() {
    modalElement.style.display = (modalElement.style.display === "flex") ? "none" : "flex";
  }

  function selectFromList(index) {
    currentIndex = index;
    updateCard();
    toggleList();
  }

  function generateList() {
    const fragment = document.createDocumentFragment();
    allData.forEach((p, index) => {
      const div = document.createElement('div');
      div.className = 'list-item';
      div.onclick = () => selectFromList(index);
      div.innerHTML = `<span>No.${p.id}</span>${p.name}`;
      fragment.appendChild(div);
    });
    listContainer.innerHTML = '';
    listContainer.appendChild(fragment);
  }

  window.onclick = function(event) { if (event.target == modalElement) toggleList(); }
  document.addEventListener('keydown', (e) => {
    if(modalElement.style.display === "flex") return;
    if (e.key === 'ArrowRight') nextCard();
    if (e.key === 'ArrowLeft') prevCard();
    if (e.key === ' ') playAudio();
  });

</script>
</body>
</html>
